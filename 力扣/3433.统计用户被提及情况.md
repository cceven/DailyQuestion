[3433](https://leetcode.cn/problems/count-mentions-per-user/solutions/3851672/tong-ji-yong-hu-bei-ti-ji-qing-kuang-by-36og5/?envType=daily-question&envId=2025-12-12)
```cpp
class Solution {
public:
    vector<int> countMentions(int numberOfUsers,
                              vector<vector<string>>& events) {
        vector<Event> sortedEvents;
        for (auto& e : events) {
            if (e[0] == "OFFLINE") {
                sortedEvents.push_back({stoi(e[1]), 0, e[2]});
            } else {
                sortedEvents.push_back({stoi(e[1]), 1, e[2]});
            }
        }

        sort(sortedEvents.begin(), sortedEvents.end(),
             [](const Event& a, const Event& b) {
                 if (a.time != b.time)
                     return a.time < b.time;
                 return a.type < b.type;
             });

        vector<int> mentions(numberOfUsers, 0);
        vector<int> online_time(numberOfUsers, 0); // 记录每个的上线时间
        for (const auto& e : sortedEvents) {
            if (e.type == 0) {
                // 更新上线时间，当前时间+60
                int id = stoi(e.content);
                online_time[id] = e.time + 60;
            } else {
                if (e.content == "ALL") {
                    // 所有的都加
                    for (int i = 0; i < numberOfUsers; i++)
                        mentions[i]++;
                } else if (e.content == "HERE") {
                    // 所有在线的都增加，找到上线时间小于等于当前时间的
                    for (int i = 0; i < numberOfUsers; i++) {
                        if (online_time[i] <= e.time)
                            mentions[i]++;
                    }
                } else {
                    // 处理给定id的情况
                    stringstream ss(e.content);
                    string temp;
                    while (ss >> temp) {
                        int id = stoi(temp.substr(2));
                        mentions[id]++;
                    }
                }
            }
        }
        return mentions;
    }

private:
    struct Event {
        int time;
        int type;
        string content;
    };
};3
```